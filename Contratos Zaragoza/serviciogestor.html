<?xml version="1.0" encoding="ISO-8859-1" ?>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="es">

<head>
    <title>Contratos Zaragoza</title>


    <link rel="stylesheet" href="C:\Users\Luis\Documents\Universidad\TFG\bootstrap-3.3.5-dist\css\bootstrap.min.css">
	<script src="C:\Users\Luis\Documents\Universidad\TFG\bootstrap-3.3.5-dist\js\bootstrap.min.js"></script>
	<link rel="shortcut icon" type="image/x-icon" href="http://www.zaragoza.es/cont/paginas/bs/img/aytoLogoCorto.png">
	<script src="js/jquery-1.10.2.min.js"></script>
    
</head>
</head>

<body>
	<div class = "container">
		<div class = "row">
<header>
			<div class ="callmd-6">
         <img class="pull-right" src="http://www.zaragoza.es/cont/paginas/bs/img/aytoLogoCorto.png" alt="Ayuntamiento de Zaragoza" />
            <h1>Lista de contratos por Servicio Gestor</h1>
			</div>
			<div class ="callmd-6">
			<p>
			A continuación se muestran los contratos por servicio gestor firmados por el ayuntamiento de Zaragoza.
			</p>
			</div>
</header>
		</div>		
			<p id="tabla"></p>
            <script type="text/javascript">
			var SPARQL_ENDPOINT = 'http://datos.zaragoza.es/sparql';
			var query = 'PREFIX pproc: <http://contsem.unizar.es/def/sector-publico/pproc#>\
PREFIX dcterms: <http://purl.org/dc/terms/>\
SELECT DISTINCT ?uri ?titulo ?servicioGestor ?id WHERE {\
?uri a <http://contsem.unizar.es/def/sector-publico/pproc#Contract>.\
?uri dcterms:title ?titulo.\
?uri pproc:contractProcedureSpecifications ?contrato.\
?uri pproc:managingDepartment ?managingDepartment.\
?managingDepartment dcterms:title ?servicioGestor.\
?managingDepartment dcterms:identifier ?id} ORDER BY ?servicioGestor';
		$.getJSON(SPARQL_ENDPOINT + '?query=' + encodeURIComponent(query) + '&format=application%2Fsparql-results%2Bjson&timeout=0')
    .success(function(data) {
	var feature;
	var table = '<table>';
	table += '<tr><td> <h2>URI</h2> </td><td> <h2>Título</h2> </td><td> <h2>Servicio Gestor</h2> </td></tr>';
	for (var i = 0; i < data.results.bindings.length; i++) {
				feature = data.results.bindings[i];
                table += '<tr><td>' + '<a href='+feature.uri.value+'>'+feature.uri.value+'</a>' + '</td><td>' + feature.titulo.value + '</td><td>' + '<a href="adjudicadosPorServicioGestor.html?servicio='+feature.id.value+'">'+feature.servicioGestor.value + '</a></td></tr>';   
                }
	table += '</table>';
	document.getElementById("tabla").innerHTML = table;
	//document.write(table);
        });
		/*var url = SPARQL_ENDPOINT
  + '?query=' + encodeURIComponent(query)
  + '&format=' + encodeURIComponent('application/sparql-results+json');
  $.getJSON(url);
  function printTable(response){
    var results = JSON.parse(response);
    var table = '<table>';
    results.results.bindings.forEach(function (result){
        table += '<tr><td>' + result.uri.value + '</td><td>' + result.titulo.value
          + '</td><td>' + result.servicioGestor.value + '</td></tr>';
    })
    table += '</table>';
    document.write(table);
}*/
            </script>
			</div>
	</div>
</body>

</html>
